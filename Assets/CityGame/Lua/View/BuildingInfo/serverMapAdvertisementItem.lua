---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/11/16/016 14:10
---


require('Framework/UI/UIPage')
local class = require 'Framework/class'

serverMapAdvertisementItem = class('serverMapAdvertisementItem')

---初始化方法   数据（读配置表）
function serverMapAdvertisementItem:initialize(prefabData,prefab,inluabehaviour,mgr,index)

    self.prefabData = prefabData;
    self.prefab = prefab;
    self._luabehaviour = inluabehaviour
    self.manager=mgr
    self.index=index
    self.metaId=prefabData.metaId


    self.numtext=prefab.transform:Find("bg/numImage/Text"):GetComponent("Text");
    self.plusBtn=prefab.transform:Find("bg/numImage/plusBtn");
    self.cutBtnBtn=prefab.transform:Find("bg/numImage/cutBtn");

    self._luabehaviour:AddClick(self.cutBtnBtn.gameObject, self.OnClick_cut, self);
    self._luabehaviour:AddClick(self.plusBtn.gameObject, self.OnClick_Plus, self);

    if prefabData.count then
        self.numtext.text=prefabData.count
        self.selfcount=prefabData.count
        self.updatecount=prefabData.count
    end



end

---添加
function serverMapAdvertisementItem:OnClick_cut(go)
    ManageAdvertisementPosPanel.greyBtn.gameObject:SetActive(false);
    if go.numtext.text-1==0 then
       go.manager.serverMapAdvertisementINSList[go.metaId].updatecount=0
        ---消除自身
        self.transform.parent.parent.parent.gameObject:SetActive(false)
        ---对应广告还原
       -- go.manager.selectItemList[go.index]:GetComponent("Image").raycastTarget=true;
        ---表数据清除
        --self.manager.serverMapAdvertisementItemList[go.index]=nil
        return
    end

    go.numtext.text=go.numtext.text-1
    go.updatecount=go.numtext.text

end

function serverMapAdvertisementItem:OnClick_Plus(ins)
    ins.numtext.text=ins.numtext.text+1
    ins.updatecount=ins.numtext.text
    ManageAdvertisementPosPanel.greyBtn.gameObject:SetActive(false);
end


