---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2019/8/13 10:39
---城市信息titleItem
CityInfoTitleItem = class('CityInfoTitleItem')
local lastBg

--初始化方法   数据（读配置表）
function CityInfoTitleItem:initialize(inluabehaviour, prefab, goodsDataInfo,msg)
    self.prefab = prefab;
    self.goodsDataInfo = goodsDataInfo;
    self._luabehaviour = inluabehaviour
    self.msg = msg
    self.id = goodsDataInfo.id
    self.type = goodsDataInfo.type

    self.notSelect = self.prefab.transform:Find("notSelectBg").gameObject
    self.notSelectText = self.prefab.transform:Find("notSelectBg/Text"):GetComponent("Text");
    self.select = self.prefab.transform:Find("selectBg")
    self.selectText = self.prefab.transform:Find("selectBg/Text"):GetComponent("Text");

    self.notSelect.transform.localScale = Vector3.one
    self.select.localScale = Vector3.zero

    self.notSelectText.text = goodsDataInfo.name
    self.selectText.text = goodsDataInfo.name

    self._luabehaviour:AddClick(self.notSelect, self.OnNotSelect, self);
end

function CityInfoTitleItem:OnNotSelect(go)
    if lastBg then
        lastBg.notSelect.transform.localScale = Vector3.one
        lastBg.select.localScale = Vector3.zero
    end
    go.notSelect.transform.localScale = Vector3.zero
    go.select.localScale = Vector3.one
    lastBg = go

    go:ShowPanel(go)
end

function CityInfoTitleItem:SetLast(ins)
    lastBg = ins
end

function CityInfoTitleItem:GetLast()
    return lastBg
end

function CityInfoTitleItem:ShowPanel(data)
    CityInfoPanel.four.gameObject:SetActive(false)
    CityInfoPanel.five.gameObject:SetActive(false)
    CityInfoPanel.six.gameObject:SetActive(false)
    if data.id == 1 then
        DataManager.DetailModelRpcNoRet(data.msg.msg.m_data.insId, 'm_querySupplyAndDemand',data.type)  --查询行业供需
        CityInfoPanel.supplyDemandBg.localScale = Vector3.one
        CityInfoPanel.rankList.localScale = Vector3.zero
    elseif data.id == 2 then
        DataManager.DetailModelRpcNoRet(data.msg.msg.m_data.insId, 'm_queryIndustryTopInfo',data.msg.msg.ownerId,data.type)  --查询收入排行
        CityInfoPanel.supplyDemandBg.localScale = Vector3.zero
        CityInfoPanel.rankList.localScale = Vector3.one
        if data.type == 20 then
            CityInfoPanel.four.gameObject:SetActive(true)
        elseif data.type ==11 or data.type ==15 or data.type ==16 then
            CityInfoPanel.five.gameObject:SetActive(true)
        elseif data.type ==12 or data.type ==13 or data.type ==14 then
            CityInfoPanel.six.gameObject:SetActive(true)
        end
    end
end