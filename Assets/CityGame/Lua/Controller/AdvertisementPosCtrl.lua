---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/10/25/025 16:24
---


require "Common/define"
require "View/BuildingInfo/BuildingInfoToggleGroupMgr";
require('Framework/UI/UIPage')
require "View/BuildingInfo/ItemCreatDeleteMgr"


local class = require 'Framework/class'
AdvertisementPosCtrl = class('AdvertisementPosCtrl',UIPage)
UIPage:ResgisterOpen(AdvertisementPosCtrl) --注册打开的方法

--构建函数
function AdvertisementPosCtrl:initialize()
    UIPage.initialize(self,UIType.Normal,UIMode.HideOther,UICollider.None);
end

function AdvertisementPosCtrl:bundleName()
    return "AdvertisementPos";
end

function AdvertisementPosCtrl:OnCreate(obj)
    UIPage.OnCreate(self,obj);
end

function AdvertisementPosCtrl:Awake(go)
    self.gameObject = go;
    local materialBehaviour = self.gameObject:GetComponent('LuaBehaviour');
    materialBehaviour:AddClick(AdvertisementPosPanel.backBtn.gameObject,self.OnClick_backBtn,self);
    materialBehaviour:AddClick(AdvertisementPosPanel.infoBtn.gameObject,self.OnClick_infoBtn,self);
    materialBehaviour:AddClick(AdvertisementPosPanel.changeNameBtn.gameObject,self.OnClick_changeName,self);

    materialBehaviour:AddClick(AdvertisementPosPanel.manageBtn.gameObject,self.OnClick_manageBtn,self)
    materialBehaviour:AddClick(AdvertisementPosPanel.confirmBtn.gameObject,self.OnClick_masterConfirm,self)
    materialBehaviour:AddClick(AdvertisementPosPanel.confirmBtn1.gameObject,self.OnClick_otherConfirm,self)
    ----------------------------------------------------------------------------------------------------------------

    AdvertisementPosPanel.qunayityInp.onValueChanged:AddListener(self.Set)
    AdvertisementPosPanel.leaseInp.onValueChanged:AddListener(self.Set)
    AdvertisementPosPanel.rentInp.onValueChanged:AddListener(self.Set)
    -------------------------------------------------------------------------------------------------------------------------
    AdvertisementPosPanel.numInp.onValueChanged:AddListener(function (arg)
        if AdvertisementPosPanel.numInp.text==""then
            return
        end
        if( AdvertisementPosPanel.numInp.text/5>=1)then
            AdvertisementPosPanel.numInp.text=5
        end
        AdvertisementPosPanel.numSlider.value=arg/5 ;

    end)

    AdvertisementPosPanel.numSlider.onValueChanged:AddListener(function (arg)
        AdvertisementPosPanel.numInp.text=math.floor(5*arg)
    end)

    AdvertisementPosPanel.maxInp.onValueChanged:AddListener(function (arg)
        if AdvertisementPosPanel.maxInp.text==""then
            return
        end
        if(AdvertisementPosPanel.maxInp.text/15>=1)then
            AdvertisementPosPanel.maxInp.text=15
        end
        AdvertisementPosPanel.maxSlider.value=arg/15;
    end)

    AdvertisementPosPanel.maxSlider.onValueChanged:AddListener(function (arg)
        AdvertisementPosPanel.maxInp.text=math.floor(15*arg)
    end)

    -----创建广告
    local creatData={count=1,buildingType=BuildingType.Municipal}
    local item =ItemCreatDeleteMgr:new(materialBehaviour,creatData)
end

--更改名字
function AdvertisementPosCtrl:OnClick_changeName()
    local data = {}
    data.titleInfo = "RENAME";
    data.tipInfo = "Modified every seven days";
    data.inputDialogPageServerType = InputDialogPageServerType.UpdateBuildingName
    UIPage:ShowPage(InputDialogPageCtrl, data)
end

--返回
function AdvertisementPosCtrl:OnClick_backBtn()
    UIPage.ClosePage();
end

--打开信息界面
function AdvertisementPosCtrl:OnClick_infoBtn()

end

function AdvertisementPosCtrl:Refresh()

end


---管理广告按钮
function AdvertisementPosCtrl:OnClick_manageBtn()

    ct.OpenCtrl("ManageAdvertisementPosCtrl")

end

function AdvertisementPosCtrl:OnClick_masterConfirm(ins)

    --主人点击确认按钮
    Event.Brocast("SmallPop","Successful adjustment")
    AdvertisementPosPanel.grey.gameObject:SetActive(true);
end

function AdvertisementPosCtrl:OnClick_otherConfirm()
    --他人点击
    ct.OpenCtrl("SignOnCtrl");
end



function AdvertisementPosCtrl:Set(toggle)

    AdvertisementPosPanel.grey.gameObject:SetActive(false);
end







