---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2019/2/27/027 18:03
---

HeadSizeType={
    big={
        [1]={ type="body",width=70,heigth=70},
        [2]={ type="backHat",width=70,heigth=70},
        [3]={ type="head",width=70,heigth=70},
        [4]={ type="decal",width=70,heigth=70},
        [5]={ type="brow",width=70,heigth=70},
        [6]={ type="hair",width=70,heigth=70},
        [7]={ type="eyes",width=70,heigth=70},
        [8]={ type="nose",width=70,heigth=70},
        [9]={ type="frontHat",width=70,heigth=70},
        [10]={ type="mouth",width=70,heigth=70},
    },
    small={




    },
}

AvatarManger={}

local  appearance={}
local num,sex,currHead
function  AvatarManger.Awake()

end


local  function setSize(go,sizeType)
    local V= UnityEngine.RectTransform.Axis.Vertical

    for i, config in ipairs(sizeType) do

    end
end

local function FindOrgan(transform)
    if not appearance["body"] then
        appearance["body"]={}
        appearance["backHat"]={}
        appearance["head"]={}
        appearance["haircut"]={}
        appearance["nose"]={}
        appearance["brow"]={}
        appearance["frontHat"]={}
        appearance["eyes"]={}
        appearance["mouth"]={}
        appearance["decal"]={}
        appearance["goatee"]={}
    end

    appearance["body"].ima=transform:Find("body"):GetComponent("Image")
    appearance["backHat"].ima=transform:Find("backHat"):GetComponent("Image")
    appearance["head"].ima=transform:Find("head"):GetComponent("Image")
    appearance["haircut"].ima=transform:Find("hair"):GetComponent("Image")
    appearance["nose"].ima=transform:Find("nose"):GetComponent("Image")
    appearance["brow"].ima=transform:Find("brow"):GetComponent("Image")
    appearance["frontHat"].ima=transform:Find("frontHat"):GetComponent("Image")
    appearance["eyes"].ima=transform:Find("eyes"):GetComponent("Image")
    appearance["mouth"].ima=transform:Find("mouth"):GetComponent("Image")

    appearance["decal"].ima=transform:Find("decal")
    appearance["goatee"].ima=transform:Find("goatee")

    if appearance["decal"].ima then
        appearance["decal"].ima=transform:Find("decal"):GetComponent("Image")
        appearance["goatee"].ima=transform:Find("goatee"):GetComponent("Image")
    end


end

local function changAparance(kind)
    local arr,path,type,nums
    arr=split(data.path,",")
    path=arr[1]
    type=arr[2]

    nums=num
    --特殊处理头和帽子
    if type=="head" then
        local config
        if sex==1 then
            config=HeadConfig.man
        else
            config=HeadConfig.woMan
        end

        currHead=creatGoods(config[nums].path)

        FindOrgan(currHead.transform)

        --加载原来服饰
        for key, value in pairs(appearance) do
            if key ~= "head"  then

                if appearance[key].path=="" then--部件不要的处理
                    if appearance[key].ima and appearance[key].ima.transform then
                        appearance[key].ima.transform.gameObject:SetActive(false)
                    end
                else--部件要的处理
                    if appearance[key].ima and appearance[key].ima.transform then
                        appearance[key].ima.transform.gameObject:SetActive(true)
                        LoadSprite(appearance[key].path,appearance[key].ima)
                    end
                end

                if key=="frontHat" then
                    if appearance["backHat"].path=="" then--部件不要的处理
                        appearance["backHat"].ima.transform.gameObject:SetActive(false)
                    else--部件不要的处理
                        appearance["backHat"].ima.transform.gameObject:SetActive(true)
                        LoadSprite(appearance["backHat"].path,appearance["backHat"].ima)
                    end
                end

            end
        end

    elseif type=="frontHat" then
        if arr[3]=="" then
            appearance[arr[4]].ima.transform.gameObject:SetActive(false)
        else
            appearance[arr[4]].ima.transform.gameObject:SetActive(true)
            LoadSprite(arr[3],appearance[arr[4]].ima)
        end
        appearance["backHat"]={}
        appearance["backHat"].path=arr[3]
    end

    appearance[type].typeId=nums
    appearance[type].type=type
    appearance[type].path=path


    if path=="" then
        appearance[type].ima.transform.gameObject:SetActive(false)
    else
        appearance[type].ima.transform.gameObject:SetActive(true)
        LoadSprite(path,appearance[type].ima)
    end

end


function AvatarManger.GetSmallAvtar(faceId)
    local arr=split(faceId,"-")
    if arr[1]=="1" then--男人
        --todo：加载小人头像
        currHead =creatGoods(HeadConfig.man[1].path)
        FindOrgan(currHead.transform)
        sex=1
        local temp=split(arr[2],",")
        for i = 1, #temp ,2 do
            if temp[i]~="" then
                local type=tonumber(temp[i])
                local typeId=tonumber(temp[i+1])
                local kind=AvtarConfig.man[type].kinds[typeId]
                num=type
                changAparance(kind)
            end
        end

    else--女人
        --todo：加载小人头像
        currHead =creatGoods(HeadConfig.woMan[1].path)
        FindOrgan(currHead.transform)
        sex=2
        local temp=split(arr[2],",")
        for i = 1, #temp ,2 do
            local kind=AvtarConfig.woMan[temp[i]].kinds[temp[i+1]].path
           changAparance(kind)
        end

    end

    return currHead
end


function AvatarManger.GetBigAvtar(faceId)
    local arr=split(faceId,"-")
    if arr[1]=="1" then--男人
        sex=1
        --todo：加载小人头像
        headPrefab[sex][1]=creatGoods(HeadConfig.man[1].path,panel.showContent)
        currHead=headPrefab[sex][1]
        FindOrgan(headPrefab[sex][1].transform)
        local temp=split(arr[2],",")
        for i = 1, #temp ,2 do
            if temp[i]~="" then
                local type=tonumber(temp[i])
                local typeId=tonumber(temp[i+1])
                local kind=AvtarConfig.man[type].kinds[typeId]
                num=type
                this:changAparance(kind)
            end
        end

    else--女人
        sex=2
        --todo：加载小人头像
        local temp=split(arr[2],",")
        for i = 1, #temp ,2 do
            local kind=AvtarConfig.woMan[temp[i]].kinds[temp[i+1]].path
            this:changAparance(kind)
        end

    end

    return currHead
end
