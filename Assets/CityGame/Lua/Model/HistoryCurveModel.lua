---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2019/3/15 16:48
---曲线图model
HistoryCurveModel = class("HistoryCurveModel",ModelBase)

function HistoryCurveModel:initialize(insId)
    self.insId = insId
    self:OnCreate()
end

function HistoryCurveModel:OnCreate()
    DataManager.RegisterErrorNetMsg()
    --Online registration
    DataManager.ModelRegisterNetMsg(nil,"sscode.OpCode","queryGoodsNpcNumCurve","ss.GoodsNpcNumCurve",self.n_OnGoodsNpcNumCurve,self) --供应曲线
    DataManager.ModelRegisterNetMsg(nil,"sscode.OpCode","queryApartmentNpcNumCurve","ss.ApartmentNpcNumCurve",self.n_OnHouseNpcNumCurve,self) --供应曲线住宅
    DataManager.ModelRegisterNetMsg(nil,"sscode.OpCode","queryNpcTypeNum","ss.NpcHourTypeNum",self.n_OnGoodsNpcTypeNum,self) --需求曲线
end

function HistoryCurveModel:Close()
    --Clear local UI events

end

--------------------客服端发包---------------------
--曲线图数据 (供应)
function HistoryCurveModel:m_GoodsNpcNumCurve(itemId)
    local msgId = pbl.enum("sscode.OpCode","queryGoodsNpcNumCurve")
    local lMsg = { id = itemId }
    local pMsg = assert(pbl.encode("ss.GoodsNpcNumCurve", lMsg))
    CityEngineLua.Bundle:newAndSendMsgExt(msgId, pMsg, CityEngineLua._tradeNetworkInterface1)
end

--曲线图数据 (供应 住宅)
function HistoryCurveModel:m_HouseNpcNumCurve()
    local msgId = pbl.enum("sscode.OpCode","queryApartmentNpcNumCurve")
    CityEngineLua.Bundle:newAndSendMsgExt(msgId, nil, CityEngineLua._tradeNetworkInterface1)
end

--曲线图数据 (需求)
function HistoryCurveModel:m_GoodsNpcTypeNum()
    local msgId = pbl.enum("sscode.OpCode","queryNpcTypeNum")
    CityEngineLua.Bundle:newAndSendMsgExt(msgId, nil, CityEngineLua._tradeNetworkInterface1)
end

-------------------Server callback---------------------

--商品供应
function HistoryCurveModel:n_OnGoodsNpcNumCurve(lMsg)
    Event.Brocast("c_GoodsNpcNumCurve",lMsg.npcNumCurveMap)
end

--住宅供应
function HistoryCurveModel:n_OnHouseNpcNumCurve(lMsg)
    Event.Brocast("c_HouseNpcNumCurve",lMsg.npcNumCurveMap)
end

function HistoryCurveModel:n_OnGoodsNpcTypeNum(lMsg)
    Event.Brocast("c_GoodsNpcTypeNum",lMsg.npcTypeNumInfo)
end