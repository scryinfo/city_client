---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2018/11/2 15:22
---中心仓库
CenterWareHouseModel = class("CenterWareHouseModel",ModelBase)
local pbl = pbl

function CenterWareHouseModel:initialize(insId)
    self.insId = insId
    self:OnCreate()
end

--启动事件--
function CenterWareHouseModel:OnCreate()
    --注册本地UI事件
    Event.AddListener("m_bagCapacity",self.m_bagCapacity,self)
    Event.AddListener("m_opCenterWareHouse",self.m_opCenterWareHouse,self)
    Event.AddListener("m_DeleteItem",self.m_DeleteItem,self)
    --as网络回调注册
    CityEngineLua.Message:registerNetMsg(pbl.enum("gscode.OpCode","moneyChange"),CenterWareHouseModel.n_GsExtendBag);
    CityEngineLua.Message:registerNetMsg(pbl.enum("gscode.OpCode","delItem"),CenterWareHouseModel.n_GsDelItem);
end

function CenterWareHouseModel:m_bagCapacity(bagCapacity)
   self.bagCapacity = bagCapacity
end

function CenterWareHouseModel:m_opCenterWareHouse()
    ct.OpenCtrl("CenterWareHouseCtrl",PlayerTempModel.roleData)
end
--仓库扩容发包
function CenterWareHouseModel:m_ExtendBag()
    local msgId = pbl.enum("gscode.OpCode","extendBag")
    CityEngineLua.Bundle:newAndSendMsg(msgId,nil);
end

--扩容回调
function CenterWareHouseModel:n_GsExtendBag(stream)
    Event.Brocast("c_GsExtendBag")
end

function CenterWareHouseModel:n_GsDelItem(stream)
    Event.Brocast("c_GsDelItem")
end

--删除商品发包
function CenterWareHouseModel:m_DeleteItem(dataId)
    DataManager.ModelSendNetMes("gscode.OpCode", "delItem","gs.DelItem",{buildingId = dataId.buildingId, item = {id = dataId.id}})
end
