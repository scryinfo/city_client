---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Tina.
--- DateTime: 2018/11/29 14:35
---

GroupItem = class('GroupItem')

-- 初始化
function GroupItem:initialize(type, luaBehaviour, prefab, data)
    self.prefab = prefab
    self.data = data

    local transform = prefab.transform

    -- 群名
    self.nameText = transform:Find("NameText"):GetComponent("Text")
    -- 群人数
    self.numberText = transform:Find("NumberBg/NumberText"):GetComponent("Text")
    -- 群重命名按钮
    self.renameBtn = transform:Find("RenameBtn").gameObject
    -- 群删除按钮
    self.deleteBtn = transform:Find("DeleteBtn").gameObject

    self.nameText.text = data.name
    self.numberText.text = data.number

    if type == 1 then -- 群组主界面
        self.renameBtn:SetActive(false)
        self.deleteBtn:SetActive(false)
    elseif type == 2 then -- 群组管理界面
        self.renameBtn:SetActive(true)
        self.deleteBtn:SetActive(true)
        luaBehaviour:AddClick(self.renameBtn, self.OnRename, self)
        luaBehaviour:AddClick(self.deleteBtn, self.OnDelete, self)
    end
end

-- 重命名
function GroupItem:OnRename(go)
    local data = {}
    data.titleInfo = "REMINDER"
    data.tipInfo = "Please input new name!"
    data.btnCallBack = function(name)
        ct.log("tina_w8_friends", "向服务器发送重命名群名")
        Event.Brocast("SmallPop","Group name was modified successfully." .. name,80)
    end
    ct.OpenCtrl("CommonDialogCtrl", data)
end

-- 退群
function GroupItem:OnDelete(go)
    local data = {}
    data.titleInfo = "WARNING"
    data.contentInfo = "Delete the production line?"
    data.tipInfo = "(The production schedule will be empty!)"
    data.btnCallBack = function()
        ct.log("tina_w8_friends", "向服务器发送退群请求")
        Event.Brocast("SmallPop","Successful exit group.",60)
    end
    ct.OpenCtrl("BtnDialogPageCtrl", data)
end