---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Tina.
--- DateTime: 2019/6/1 17:16
---

EvaResultItem = class("EvaResultItem")
EvaResultItem.static.ItemNameConfig = -- icon显示配置
{
    [13] = "零售店",
    [14] = "住宅",
    [1613] = "零售店",
    [1614] = "住宅",
    [1651] = "食品",
    [1652] = "服饰",
    [155] = "发明商品",
    [156] = "Eva点数研究",
}

-- 初始化
function EvaResultItem:initialize(perfab, data, index)
    local transform = perfab.transform
    local datas = data.evasInfo

    if index == 1 then
        transform:Find("LineImage").localScale = Vector3.zero
    else
        transform:Find("LineImage").localScale = Vector3.one
    end

    local rootTab = { {root = transform:Find("LeftRoot"), tempData = datas.old_eva}, {root = transform:Find("RightRoot"), tempData = datas.new_eva}}
    for i, v in ipairs(rootTab) do
        local configData = {}
        for _, k in ipairs(EvaBaseData) do
            if k.Atype == v.tempData.at and k.Btype == v.tempData.bt then
                configData = k
            end
        end
        v.root:Find("LevelText"):GetComponent("Text").text = string.format("Lv.%s", v.tempData.lv)
        local nameText = v.root:Find("NameText"):GetComponent("Text")
        -- 刷新界面上的数据显示

        local iconRoot = v.root:Find("IconRoot")
        local iconImage = v.root:Find("IconRoot/IconImage"):GetComponent("Image")
        iconRoot.localScale = Vector3.New(0, 0, 0)
        local imgPath
        local idStr = string.sub(v.tempData.at,  1, 2)
        if idStr == "21" then
            imgPath = Material[v.tempData.at].img
            nameText.text = GetLanguage(v.tempData.at)
            iconRoot.localScale = Vector3.New(0.5, 0.5, 1)
        elseif idStr == "22" then
            imgPath = Good[v.tempData.at].img
            nameText.text = GetLanguage(v.tempData.at)
            iconRoot.localScale = Vector3.New(0.5, 0.5, 1)
        else
            imgPath = BrandItem.static.brandIcon[v.tempData.at]
            nameText.text = EvaResultItem.static.ItemNameConfig[v.tempData.at]
            iconRoot.localScale = Vector3.New(1, 1, 1)
        end
        LoadSprite(imgPath, iconImage, true)

        v.root:Find("PropertyNumberText"):GetComponent("Text").text = string.format("%s +%s", configData.name, GetEvaPercent(v.tempData.lv))
        if idStr == "22" and v.tempData.bt == "Quality" then
            local qualityNumberText = v.root:Find("QualityNumberText")
            qualityNumberText.localScale = Vector3.New(1, 1, 1)
            qualityNumberText:GetComponent("Text").text = "Quality" .. GetEvaPercent(v.tempData.lv)
            v.root:Find("LargeNumberText").localScale = Vector3.New(0, 0, 0)
            v.root:Find("MediumNumberText").localScale = Vector3.New(0, 0, 0)
            v.root:Find("SmallNumberText").localScale = Vector3.New(0, 0, 0)
            if i == 1 then
                transform.sizeDelta = Vector2.New(1000, 300)
            end
        else
            v.root:Find("QualityNumberText").localScale = Vector3.New(0, 0, 0)
            local largeNumberText = v.root:Find("LargeNumberText")
            largeNumberText.localScale = Vector3.New(1, 1, 1)
            local MediumNumberText = v.root:Find("MediumNumberText")
            MediumNumberText.localScale = Vector3.New(1, 1, 1)
            local SmallNumberText = v.root:Find("SmallNumberText")
            SmallNumberText.localScale = Vector3.New(1, 1, 1)
            largeNumberText:GetComponent("Text").text = "Large " .. GetEvaData(3, configData, v.tempData.lv)
            MediumNumberText:GetComponent("Text").text = "Medium " .. GetEvaData(2, configData, v.tempData.lv)
            SmallNumberText:GetComponent("Text").text = "Small " .. GetEvaData(1, configData, v.tempData.lv)
            if i == 1 then
                transform.sizeDelta = Vector2.New(1000, 400)
            end
        end
    end
end