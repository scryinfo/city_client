---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Tina.
--- DateTime: 2019/5/28 15:47
---

BaseEvaTitleItem = class("BaseEvaTitleItem")

-- 初始化
function BaseEvaTitleItem:initialize(prefab, optionIndex, index)
    self.prefab = prefab
    self.transform = prefab.transform
    self.optionIndex = optionIndex
    self.index = index

    self.btn = self.transform:GetComponent("Button")
    self.nameText = self.transform:Find("Text"):GetComponent("Text")
    self.iconAddImage = self.transform:Find("IconAddImage")
    self.iconAddTextTF = self.transform:Find("IconAddText")
    self.iconAddText = self.transform:Find("IconAddText"):GetComponent("Text")
    self:_showContent()

    local nowOptionIndex = EvaCtrl.static.evaCtrl:GetEvaRecordData()[self.optionIndex]
    if nowOptionIndex and nowOptionIndex == index then
        self:SetSelect(false)
    else
        self:SetSelect(true)
    end

    self.btn.onClick:RemoveAllListeners()
    self.btn.onClick:AddListener(function()
        self:_onClickBtn()
    end)
end

-- 设置按钮的是否可点
function BaseEvaTitleItem:SetSelect(isSelect)
    self.btn.interactable = isSelect
    self:_setNameTextColor(isSelect)
end

-- 设置已加点的数量
function BaseEvaTitleItem:_setAddNumber(number)
    if number and number > 0 then
        self.iconAddImage.localScale = Vector3.one
        self.iconAddTextTF.localScale = Vector3.one
        self.iconAddText.text = tostring(number) --string.format("E%s", number)
    else
        self.iconAddImage.localScale = Vector3.zero
        self.iconAddTextTF.localScale = Vector3.zero
    end
end

-- 子类继承实现自己的方法用以显示具体的内容
function BaseEvaTitleItem:_showContent()

end

-- 按钮点击事件、子类继承实现自己的方法
function BaseEvaTitleItem:_onClickBtn()
    -- 重置按钮状态
    EvaCtrl.static.evaCtrl:SetBtnState(self.optionIndex)
    self:SetSelect(false)
    -- 刷新选择的按钮数据
    EvaCtrl.static.evaCtrl:SetEvaRecord(self.optionIndex, self.index)
end

-- 设置按钮文字的颜色、子类继承实现自己的方法
function BaseEvaTitleItem:_setNameTextColor(isSelect)

end