---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xuyafang.
--- DateTime: 2018/9/21 10:35
---
-----

FlightChoosePlaceCtrl = class('FlightChoosePlaceCtrl',UIPanel)
UIPanel:ResgisterOpen(FlightChoosePlaceCtrl)

function FlightChoosePlaceCtrl:initialize()
    UIPanel.initialize(self, UIType.Normal, UIMode.DoNothing, UICollider.None)
end

function FlightChoosePlaceCtrl:bundleName()
    return "Assets/CityGame/Resources/View/FlightChoosePlacePanel.prefab"
end

function FlightChoosePlaceCtrl:OnCreate(obj)
    UIPanel.OnCreate(self, obj)
end

function FlightChoosePlaceCtrl:Awake(go)
    self.gameObject = go
    self:_getComponent(go)

    self.chooseEvent = VScrollEventData.New()
    self.chooseEvent.mProvideData = FlightChoosePlaceCtrl.static.ProvideFunc
    self.chooseEvent.mClearData = FlightChoosePlaceCtrl.static.ClearFunc
    self.chooseScroll:InitComponent(self.chooseEvent)

    local behaviour = self.gameObject:GetComponent('LuaBehaviour')
    behaviour:AddClick(self.backBtn.gameObject, function ()
        self:backFunc()
    end , self)
end

function FlightChoosePlaceCtrl:Refresh()
    self:_initData()
end

function FlightChoosePlaceCtrl:Active()
    UIPanel.Active(self)
    Event.AddListener("FlightChoosePlaceEvent", self.choosePlaceEvent, self)
end

function FlightChoosePlaceCtrl:Hide()
    UIPanel.Hide(self)
    Event.RemoveListener("FlightChoosePlaceEvent", self.choosePlaceEvent, self)
end
--
FlightChoosePlaceCtrl.static.ProvideFunc = function(transform, idx)
    --idx = idx + 1
    --local item = FlightSelectPlaceItem:new(transform, {value = FlightChoosePlaceCtrl.totalValue[idx]})
    local item = FlightSelectPlaceItem:new(transform, {value = "AAAAAAA"})
    if FlightChoosePlaceCtrl.static.itemsList[idx] ~= nil then
        FlightChoosePlaceCtrl.static.itemsList[idx]:Close()
    end
    FlightChoosePlaceCtrl.static.itemsList[idx] = item
end
--
FlightChoosePlaceCtrl.static.ClearFunc = function(transform) end

--
function FlightChoosePlaceCtrl:_getComponent(go)
    if go == nil then
        return
    end
    local trans = go.transform
    self.backBtn = trans:Find("topRoot/backBtn")
    self.chooseScroll = trans:Find("scrollRoot/scroll"):GetComponent("VScrollLoop")
    self.titleText01 = trans:Find("topRoot/Text"):GetComponent("Text")
end
--
function FlightChoosePlaceCtrl:_initData()
    --热门城市
    if self.m_data.popularCity ~= nil then

    end
    self:cleanItemList()
    self:_TempCreateConfig()
    self.chooseScroll:InitData(self.tempDetailDic, self.tempTitleData)
end
--
function FlightChoosePlaceCtrl:cleanItemList()
    if FlightChoosePlaceCtrl.static.itemsList == nil then
        FlightChoosePlaceCtrl.static.itemsList = {}
        return
    end
    for i, value in pairs(FlightChoosePlaceCtrl.static.itemsList) do
        value:Close()
    end
end
--
function FlightChoosePlaceCtrl:_TempCreateConfig()
    self.tempTitleData = {"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",}
    self.tempDetailDic = System.Collections.Generic.Dictionary_string_strings.New()
    FlightChoosePlaceCtrl.totalValue = {}
    for i, value in ipairs(self.tempTitleData) do
        local tempValue = {value.."aaa", value.."bbb", value.."ddd", value.."ccc", value.."vvv"}
        --FlightChoosePlaceCtrl.totalValue:AddRange(tempValue)
        self.tempDetailDic:Add(value, tempValue)
    end
end
--
function FlightChoosePlaceCtrl:_language()

end
--
function FlightChoosePlaceCtrl:backFunc()
    self.chooseScroll:CleanAll()
    PlayMusEff(1002)
    UIPanel.ClosePage()
end

--
function FlightChoosePlaceCtrl:choosePlaceEvent(data)
    if data ~= nil and self.m_data.callback ~= nil then
        self.m_data.callback(data)
        self:backFunc()
    end
end