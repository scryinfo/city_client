---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xuyafang.
--- DateTime: 2019/2/27 18:13
---建筑主界面调整工资
BuildingSalaryDetailPart = class('BuildingSalaryDetailPart', BasePartDetail)
--
function BuildingSalaryDetailPart:PrefabName()
    return "BuildingSalaryDetailPart"
end
--
function BuildingSalaryDetailPart:RefreshData(data)
    self.m_data = data
    self:_initFunc()
end
--
function BuildingSalaryDetailPart:_InitTransform()
    self:_getComponent(self.transform)
end
--
function BuildingSalaryDetailPart:_getComponent(transform)
    if transform == nil then
        return
    end
    self.closeBtn = transform:Find("root/closeBtn"):GetComponent("Button")
    self.confirmBtn = transform:Find("root/confirmBtn"):GetComponent("Button")

    self.staffNumText = transform:Find("root/staffNum/staffNumText"):GetComponent("Text")
    self.standardWageText = transform:Find("root/wage/standardWageText"):GetComponent("Text")
    self.wageSlider = transform:Find("root/wageSlider"):GetComponent("Slider")
    self.effectiveDateText = transform:Find("root/effectiveDateText"):GetComponent("Text")

    self.select50Text = transform:Find("root/wageLevel/00/selectText")
    self.select75Text = transform:Find("root/wageLevel/01/selectText")
    self.select100Text = transform:Find("root/wageLevel/02/selectText")
    self.simple50Text = transform:Find("root/wageLevel/00/Text")
    self.simple75Text = transform:Find("root/wageLevel/01/Text")
    self.simple100Text = transform:Find("root/wageLevel/02/Text")

    self.effectText = transform:Find("root/bg/bg01/effectText"):GetComponent("Text")
    self.totalText = transform:Find("root/bg/bg02/totalText"):GetComponent("Text")
end
--
function BuildingSalaryDetailPart:_initFunc()
    if self.m_data == nil then
        return
    end

    if self.m_data.salary ~= nil then
        self:_showPercentValue((self.m_data.salary - 50) / 15)  --工资比率
    else
        self:_showPercentValue(2)
    end

    local standardWage = DataManager.GetBuildingStandardWage()
    if standardWage == nil then
        DataManager.m_ReqStandardWage(self.m_data.buildingType)
    else
        self.standardWageText.text = string.format("E%s/d", GetClientPriceString(standardWage))
    end

    local staffNum = PlayerBuildingBaseData[self.m_data.buildingType].maxWorkerNum
    self.staffNumText.text = staffNum
    local trueTextW = self.effectiveDateText.preferredWidth
    self.effectiveDateText.rectTransform.sizeDelta = Vector2.New(trueTextW, self.effectiveDateText.rectTransform.sizeDelta.y)

    self.effectTime = TimeSynchronized.GetTheCurrentTime()
    self.effectiveDateText.text = os.date("%Y/%m%d %H:%M:%S", self.effectTime)
end

--根据选中的档位显示数据
function BuildingSalaryDetailPart:_showPercentValue(level)
    if level == 0 then
        self.simple50Text.localScale = Vector3.zero
        self.simple75Text.localScale = Vector3.one
        self.simple100Text.localScale = Vector3.one

        self.select50Text.localScale = Vector3.one
        self.select75Text.localScale = Vector3.zero
        self.select100Text.localScale = Vector3.zero
    elseif level == 1 then
        self.simple50Text.localScale = Vector3.one
        self.simple75Text.localScale = Vector3.zero
        self.simple100Text.localScale = Vector3.one

        self.select50Text.localScale = Vector3.zero
        self.select75Text.localScale = Vector3.one
        self.select100Text.localScale = Vector3.zero
    elseif level == 2 then
        self.simple50Text.localScale = Vector3.one
        self.simple75Text.localScale = Vector3.one
        self.simple100Text.localScale = Vector3.zero

        self.select50Text.localScale = Vector3.zero
        self.select75Text.localScale = Vector3.zero
        self.select100Text.localScale = Vector3.one
    end
end
