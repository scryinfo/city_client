---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2018/12/15 17:25
---通知Model
GameNoticeModel = class("GameNoticeModel",ModelBase)
local pbl = pbl

function GameNoticeModel:initialize(insId)
    self.insId = insId
    self:OnCreate()
end

function GameNoticeModel:OnCreate()
    --网络回调
    -- DataManager.ModelRegisterNetMsg(self.insId,"gscode.OpCode","deleMail","gs.mailId",self.n_OnDeleMails)
    CityEngineLua.Message:registerNetMsg(pbl.enum("gscode.OpCode","mailRead"),GameNoticeModel.n_OnMailRead);
    CityEngineLua.Message:registerNetMsg(pbl.enum("gscode.OpCode","delMail"),GameNoticeModel.n_OnDeleMails);

end

function GameNoticeModel:Close()
    --清空本地UI事件
end
--客户端请求--

--读取邮件
function GameNoticeModel:m_mailRead(mailId)
    DataManager.ModelSendNetMes("gscode.OpCode", "mailRead","gs.Id",{id = mailId})

end

--删除邮件
function GameNoticeModel:m_delMail(mailId)
    DataManager.ModelSendNetMes("gscode.OpCode", "delMail","gs.Id",{id = mailId})

end

--服务器回调--

--查看
function GameNoticeModel.n_OnMailRead(stream)
    local lMsg = assert(pbl.decode("gs.Id", stream),"LoginModel.n_GsLoginSuccessfully stream == nil")
    local go = NoticeMgr.notice[lMsg.id]
    Event.Brocast("c_OnMailRead",go)
end

--删除
function GameNoticeModel.n_OnDeleMails(stream)
    --DataManager.ControllerRpcNoRet(self.insId,"GameMainInterfaceCtrl", '_delMails',stream)
    local lMsg = assert(pbl.decode("gs.Id", stream),"LoginModel.n_GsLoginSuccessfully stream == nil")
    local go = NoticeMgr.notice[lMsg.id]
    Event.Brocast("c_OnDeleMails",go)
end
