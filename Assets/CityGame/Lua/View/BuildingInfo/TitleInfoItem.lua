---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2019/8/21 15:17
---城市信息第三层item
--初始化方法   数据（读配置表）
TitleInfoItem = class('TitleInfoItem')
local lastBg

function TitleInfoItem:initialize(inluabehaviour, prefab, goodsDataInfo,itemId,type,insId)
    self.prefab = prefab;
    self.goodsDataInfo = goodsDataInfo;
    self._luabehaviour = inluabehaviour
    self.itemId = itemId
    self.id = goodsDataInfo.id
    self.type = type
    self.insId = insId

    self.notSelect = self.prefab.transform:Find("notSelectBg").gameObject
    self.notSelectText = self.prefab.transform:Find("notSelectBg/Text"):GetComponent("Text");
    self.select = self.prefab.transform:Find("selectBg")
    self.selectText = self.prefab.transform:Find("selectBg/Text"):GetComponent("Text");

    self.notSelectText.text = GetLanguage(goodsDataInfo.name)
    self.selectText.text = GetLanguage(goodsDataInfo.name)

    self._luabehaviour:AddClick(self.notSelect, self.OnNotSelect, self);
    self._luabehaviour:AddClick(CityInfoPanel.threeEvaTechnologyBtn, self.OnThreeEvaTechnologyBtn, self);
    self._luabehaviour:AddClick(CityInfoPanel.threeEvaAdvertisingBtn, self.OnThreeEvaAdvertisingBtn, self);
    self._luabehaviour:AddClick(CityInfoPanel.threeEvaSpeedBtn, self.OnThreeEvaSpeedBtn, self);
end

function TitleInfoItem:OnNotSelect(go)
    PlayMusEff(1002)
    go:ShowPanel(go)
    if go.id == 1 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_queryItemSales',go.type,go.itemId)  --查询营业额
        CityInfoPanel.threeSum.text = GetLanguage(45020027)
        CityInfoPanel.threeDate.text = GetLanguage(45010014)
    elseif go.id == 2 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_ItemSupplyAndDemand',go.type,go.itemId)  --查询供需
        CityInfoPanel.threeSum.text = GetLanguage(45010013)
        CityInfoPanel.threeDate.text = GetLanguage(45010014)
        CityInfoPanel.threeSupplyDemand.localScale = Vector3.one
    elseif go.id == 3 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_queryItemAvgPrice',go.type,go.itemId)  --查询详情成交均价
        CityInfoPanel.threeSum.text = GetLanguage(45020030)
        CityInfoPanel.threeDate.text = GetLanguage(45010014)
    elseif go.id == 4 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_queryProductRanking',go.type,go.itemId,DataManager.GetMyOwnerID())  --查询详情玩家排行
        CityInfoPanel.threeCurveBg.localScale = Vector3.zero
        CityInfoPanel.threeRank:SetActive(true)
        if go.type == 11 or go.type == 15 or go.type == 16 then
            CityInfoPanel.detailFive:SetActive(true)
            CityInfoPanel.detailSix:SetActive(false)
        elseif go.type == 12 or go.type == 13 then
            CityInfoPanel.detailFive:SetActive(false)
            CityInfoPanel.detailSix:SetActive(true)
        end
    elseif go.id == 5 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_queryEvaGrade',go.type,go.itemId,2)  --查询详情玩家Eva
        CityInfoPanel.threeSum.text = GetLanguage(45020023)
        CityInfoPanel.threeDate.text = GetLanguage(45020024)
        CityInfoPanel.threeEva.localScale = Vector3.one
        CityInfoPanel.threeEvaTechnologyBtn.transform.localScale = Vector3.zero
        CityInfoPanel.threeEvaAdvertisingBtn.transform.localScale = Vector3.one
        CityInfoPanel.threeEvaSpeedBtn.transform.localScale = Vector3.one
        if go.type == 12 then
            CityInfoPanel.threeEvaSpeed.localScale = Vector3.one
            CityInfoPanel.threeEvaAdvertising.localScale = Vector3.one
        elseif go.type == 11 then
            CityInfoPanel.threeEvaSpeed.localScale = Vector3.zero
            CityInfoPanel.threeEvaAdvertising.localScale = Vector3.one
        elseif go.type == 15 or go.type == 16 then
            CityInfoPanel.threeEvaAdvertising.localScale = Vector3.zero
            CityInfoPanel.threeEvaSpeed.localScale = Vector3.zero
        end
    end
end

--详情Eva分布科技
function TitleInfoItem:OnThreeEvaTechnologyBtn(go)
    DataManager.DetailModelRpcNoRet(go.insId, 'm_queryEvaGrade',go.type,go.itemId,2)
    CityInfoPanel.threeEvaTechnologyBtn.transform.localScale = Vector3.zero
    CityInfoPanel.threeEvaAdvertisingBtn.transform.localScale = Vector3.one
    CityInfoPanel.threeEvaSpeedBtn.transform.localScale = Vector3.one
end

--详情Eva分布推广
function TitleInfoItem:OnThreeEvaAdvertisingBtn(go)
    DataManager.DetailModelRpcNoRet(go.insId, 'm_queryEvaGrade',go.type,go.itemId,1)
    CityInfoPanel.threeEvaTechnologyBtn.transform.localScale = Vector3.one
    CityInfoPanel.threeEvaAdvertisingBtn.transform.localScale = Vector3.zero
    CityInfoPanel.threeEvaSpeedBtn.transform.localScale = Vector3.one
end

--详情Eva分布速度
function TitleInfoItem:OnThreeEvaSpeedBtn(go)
    DataManager.DetailModelRpcNoRet(go.insId, 'm_queryEvaGrade',go.type,go.itemId,3)
    CityInfoPanel.threeEvaTechnologyBtn.transform.localScale = Vector3.one
    CityInfoPanel.threeEvaAdvertisingBtn.transform.localScale = Vector3.one
    CityInfoPanel.threeEvaSpeedBtn.transform.localScale = Vector3.zero
end

function TitleInfoItem:ShowPanel(go)
    if lastBg then
        lastBg.notSelect.transform.localScale = Vector3.one
        lastBg.select.localScale = Vector3.zero
    end
    go.notSelect.transform.localScale = Vector3.zero
    go.select.localScale = Vector3.one
    lastBg = go
    CityInfoPanel.productContent.anchoredPosition = Vector3.zero
    CityInfoPanel.threeCurveBg.localScale = Vector3.one
    CityInfoPanel.threeRank:SetActive(false)
    CityInfoPanel.threeSupplyDemand.localScale = Vector3.zero
    CityInfoPanel.threeEva.localScale = Vector3.zero
end

function TitleInfoItem:SetLast(bg)
    lastBg = bg
end