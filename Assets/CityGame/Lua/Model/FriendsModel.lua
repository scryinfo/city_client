---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Tina.
--- DateTime: 2018/12/6 10:52
---

FriendsModel = class("FriendsModel",ModelBase)

function FriendsModel:initialize(insId)
    self.insId = insId
    self:OnCreate()
end

function FriendsModel:OnCreate()
    -- 注册事件
    Event.AddListener("m_QueryPlayerInfo", self.m_QueryPlayerInfo)
    Event.AddListener("m_SearchPlayer", self.m_SearchPlayer)
    Event.AddListener("m_AddFriends", self.m_AddFriends)
    Event.AddListener("m_AddFriendsReq", self.m_AddFriendsReq)
    Event.AddListener("m_DeleteFriend", self.m_DeleteFriend)
    Event.AddListener("m_DeleteBlacklist", self.m_DeleteBlacklist)

    -- 网络回调注册
    DataManager.ModelRegisterNetMsg(nil,"gscode.OpCode","searchPlayer","gs.RoleInfos", self.n_OnReceiveSearchPlayerInfo, self)
end

function FriendsModel.Close()
    -- 清空事件
end

-- 向服务器查询好友信息
function FriendsModel.m_QueryPlayerInfo(friendsIds)
    DataManager.ModelSendNetMes("gscode.OpCode", "queryPlayerInfo","gs.Bytes",{ ids = friendsIds })
end

-- 搜索用户（用户名）
function FriendsModel.m_SearchPlayer(nameStr)
    DataManager.ModelSendNetMes("gscode.OpCode", "searchPlayer","gs.Str",{ str = nameStr })
end

-- 收到好友信息
function FriendsModel:n_OnReceiveSearchPlayerInfo(friendsData)
    Event.Brocast("c_OnReceiveSearchPlayerInfo", friendsData)
end

-- 加好友（玩家Id）
function FriendsModel.m_AddFriends(friendId, descStr)
    DataManager.ModelSendNetMes("gscode.OpCode", "addFriend","gs.ByteStr",{ id = friendId, desc = descStr })
end

-- 处理好友申请
function FriendsModel.m_AddFriendsReq(friendId, b)
    DataManager.ModelSendNetMes("gscode.OpCode", "addFriendReq","gs.ByteBool",{ id = friendId, b = b })
end

-- 删除好友申请
function FriendsModel.m_DeleteFriend(friendId)
    DataManager.ModelSendNetMes("gscode.OpCode", "deleteFriend","gs.Id",{ id = friendId })
end

-- 解除屏蔽
function FriendsModel.m_DeleteBlacklist(friendsId)
    DataManager.ModelSendNetMes("gscode.OpCode", "deleteBlacklist","gs.Id",{ id = friendsId })
end