---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2019/4/28 14:56
---推广签约item
PromoteSignItem = class('PromoteSignItem')
--初始化方法
function PromoteSignItem:initialize(dataInfo, viewRect,luaBehavior)
    self.dataInfo = dataInfo
    self.viewRect = viewRect
    self.luaBehavior = luaBehavior
    local viewTrans = self.viewRect

    self.bg = viewTrans:Find("bg").gameObject
    self.head = viewTrans:Find("head/headBg"):GetComponent("Image")  --头像
    self.name = viewTrans:Find("head/headBg/name"):GetComponent("Text")  --名字
    self.building = viewTrans:Find("building"):GetComponent("Image")  --建筑图片
    self.buildingName = viewTrans:Find("building/name"):GetComponent("Text")  --建筑名字
    self.buildingType = viewTrans:Find("building/buildingNmae"):GetComponent("Text")  --建筑类型
    self.time = viewTrans:Find("signTime/time"):GetComponent("Text")  --签约时长
    self.slider = viewTrans:Find("Slider"):GetComponent("Slider")
    self.timeText = viewTrans:Find("timeText"):GetComponent("Text")

    self.price = viewTrans:Find("unitPrice/price"):GetComponent("Text")  --签约价格
    self.bonus = viewTrans:Find("promoteBonus/bonus"):GetComponent("Text")  --签约加成

    if dataInfo.typeId == 13 then
        LoadSprite("Assets/CityGame/Resources/Atlas/PromoteCompany/icon-supermarket.png", self.building, true)
    elseif dataInfo.typeId  == 14 then
        LoadSprite("Assets/CityGame/Resources/Atlas/PromoteCompany/icon-house.png", self.building, true)
    end
    self.time.text = dataInfo.signingHours .. "d"
    self.buildingName.text = dataInfo.buildingName

    self.buildingType.text = GetLanguage(PlayerBuildingBaseData[dataInfo.typeId].typeName)
    local currentTime = TimeSynchronized.GetTheCurrentServerTime()    --服务器当前时间(毫秒)

    self.timeText.text = getFormatUnixTime((currentTime - dataInfo.startTs)/1000).day.." "  .. getFormatUnixTime((currentTime - dataInfo.startTs)/1000).hour

    self.slider.value = (currentTime - dataInfo.startTs) / (dataInfo.signingHours*3600000)
    PlayerInfoManger.GetInfos({dataInfo.sellerPlayerId}, self.c_OnHead, self)

    self.price.text = GetClientPriceString(dataInfo.pricePerHour)
    self.bonus.text = math.ceil(dataInfo.lift *100)/100 .. "%"

    --luaBehavior:AddClick(self.bg, self.OnBg, self)
end

function PromoteSignItem:c_OnHead(info)
    AvatarManger.GetSmallAvatar(info[1].faceId,self.head.transform,0.14)
    self.name.text = info[1].name
end

function PromoteSignItem:OnBg(go)

end