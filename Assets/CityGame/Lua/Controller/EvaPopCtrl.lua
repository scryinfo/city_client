---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Tina.
--- DateTime: 2019/6/1 17:12
---

EvaPopCtrl = class("EvaPopCtrl", UIPanel)
UIPanel:ResgisterOpen(EvaPopCtrl)

EvaPopCtrl.static.EvaResultItemPath = "View/Eva/EvaResultItem"  -- Sliding prefabricated path

function EvaPopCtrl:initialize()
    UIPanel.initialize(self, UIType.PopUp, UIMode.DoNothing, UICollider.None)
end

function EvaPopCtrl:bundleName()
    return "Assets/CityGame/Resources/View/EvaPopPanel.prefab"
end

function EvaPopCtrl:OnCreate(obj)
    UIPanel.OnCreate(self, obj)
end

function EvaPopCtrl:Awake()
    local transform = self.gameObject.transform
    local luaBehaviour = self.gameObject:GetComponent("LuaBehaviour")
    local sureBtn = transform:Find("Bg/SureBtn")
    self.resultScroll = transform:Find("Bg/ScrollView"):GetComponent("ActiveLoopScrollRect")

    luaBehaviour:AddClick(sureBtn.gameObject, self.OnBack, self)

    -- Result node
    self.evaResultSource = UnityEngine.UI.LoopScrollDataSource.New()
    self.evaResultSource.mProvideData = EvaPopCtrl.static.evaResultData
    self.evaResultSource.mClearData = EvaPopCtrl.static.evaResultClearData
end

function EvaPopCtrl:Active()
    UIPanel.Active(self)
end

function EvaPopCtrl:Refresh()
    EvaPopCtrl.resultInfo = self.m_data
    self.resultScroll:ActiveLoopScroll(self.evaResultSource, #self.m_data, EvaPopCtrl.static.EvaResultItemPath)
end

function EvaPopCtrl:Hide()
    EvaPopCtrl.resultInfo = nil
    UIPanel.Hide(self)
end

-- Close Eva results interface
function EvaPopCtrl:OnBack(go)
    PlayMusEff(1002)
    UIPanel.ClosePage()
end

-- Eva result information display
EvaPopCtrl.static.evaResultData = function(transform, idx)
    idx = idx + 1
    EvaResultItem:new(transform, EvaPopCtrl.resultInfo[idx], idx)
end

EvaPopCtrl.static.evaResultClearData = function(transform)
end