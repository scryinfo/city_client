---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xuyafang.
--- DateTime: 2018/9/19 10:04
---建筑首页信息显示toggle

BuildingInfoToggleItem = {}

function BuildingInfoToggleItem.New()
    local elm = {}

    elm.viewRect = nil  --引用的对应UI组件
    elm.BuildingInfoToggleState = BuildingInfoToggleState.Close  --状态
    elm.targetMovePos = nil  --目标移动点

    elm.openStateTran = nil  --组件
    elm.closeStateTran = nil
    elm.toDoBtn = nil
    elm.openBtn = nil
    elm.contentRoot = nil

    elm.InitElm = BuildingInfoToggleItem.InitElm  --方法
    elm.OpenToggleItem = BuildingInfoToggleItem.OpenToggleItem
    elm.CloseToggleItem = BuildingInfoToggleItem.CloseToggleItem
    setmetatable(elm, elm)
    return elm
end

--初始化方法
function BuildingInfoToggleItem:InitElm(clickOpenFunc, toDoFunc, viewRect, mainPanelLuaBehaviour)
    self.viewRect = viewRect

    if toDoFunc == nil then
        self.toDoBtn.transform.localScale = Vector3.zero  --如果没有可执行方法，则隐藏按钮
    else
        self.toDoBtn.transform.localScale = Vector3.one
    end

    self.openStateTran = self.view.transform:Find("openState");  --打开状态 --因为显示和打开的区别还是挺大的，所以就分开显示
    self.closeStateTran = self.view.transform:Find("closeState");  --关闭状态
    self.toDoBtn = self.view.transform:Find("openState/funcBtn"):GetComponent("Button");  --打开之后的显示按钮，可能不需要显示，当没有需要做的动作时
    self.openBtn = self.view.transform:Find("closeState/openBtn"):GetComponent("Button");  --打开按钮
    self.contentRoot = self.view.transform:Find("contentRoot");  --显示内容

    mainPanelLuaBehaviour:AddClick(self.toDoBtn, toDoFunc);
    mainPanelLuaBehaviour:AddClick(self.openBtn, clickOpenFunc);
end

--打开
function BuildingInfoToggleItem:OpenToggleItem(targetMovePos)
    self.BuildingInfoToggleState = BuildingInfoToggleState.Open
    self.targetMovePos = targetMovePos

    self.openStateTran.localScale = Vector3.one
    self.closeStateTran.localScale = Vector3.zero

    self.contentRoot.localScale = Vector3.one --打开显示内容
    self.viewRect.anchoredPosition = targetMovePos  --移动到目标位置
end

--关闭
function BuildingInfoToggleItem:CloseToggleItem(targetMovePos)
    self.BuildingInfoToggleState = BuildingInfoToggleState.Close
    self.targetMovePos = targetMovePos

    self.openStateTran.localScale = Vector3.zero
    self.closeStateTran.localScale = Vector3.one

    self.contentRoot.localScale = Vector3.zero --打开显示内容
    self.viewRect.anchoredPosition = targetMovePos  --移动到目标位置

end