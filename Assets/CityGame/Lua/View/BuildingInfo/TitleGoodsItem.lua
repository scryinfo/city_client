---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2019/8/21 10:54
---城市信息第二层列表
TitleGoodsItem = class('TitleGoodsItem')
local lastBg

--初始化方法   数据（读配置表）
function TitleGoodsItem:initialize(inluabehaviour, prefab, goodsDataInfo,msg,titleInfoItem,type,insId)
    self.prefab = prefab;
    self.goodsDataInfo = goodsDataInfo;
    self._luabehaviour = inluabehaviour
    self.msg = msg
    self.titleInfoItem = titleInfoItem
    self.type = type
    self.insId = insId

    self.bg = self.prefab.transform:Find("bg"):GetComponent("Image")
    self.icon = self.prefab.transform:Find("icon"):GetComponent("Image")
    self.iconText = self.prefab.transform:Find("icon/Text"):GetComponent("Text")

    if self.msg.type == 11 or self.msg.type == 12 or self.msg.type == 13 then
        self.icon.sprite = SpriteManager.GetSpriteByPool(goodsDataInfo.itemId)
    end
    self.iconText.text = goodsDataInfo.name

    self._luabehaviour:AddClick(self.bg.gameObject, self.OnBg, self);
end

function TitleGoodsItem:OnBg(go)
    DataManager.DetailModelRpcNoRet(go.insId, 'm_queryItemSales',go.type,go.goodsDataInfo.itemId)  --查询营业额
    --CityInfoPanel.productContent.anchoredPosition = Vector3.zero
    if lastBg then
        lastBg.color = getColorByInt(255,255,255,255)
    end
    go.bg.color = getColorByInt(225,233,255,255)
    lastBg = go.bg

    if go.msg.type == 11 or go.msg.type == 12 or go.msg.type == 13 then
        CityInfoPanel.productIcon.sprite = SpriteManager.GetSpriteByPool(go.goodsDataInfo.itemId)
    end
    CityInfoPanel.productText.text = go.goodsDataInfo.name
    CityInfoPanel.productDown.transform.localScale = Vector3.one
    CityInfoPanel.productUp.localScale = Vector3.zero
    CityInfoPanel.productsList:SetActive(false)

    if go.titleInfoItem and next(go.titleInfoItem) then
        for i, v in pairs(go.titleInfoItem) do
            v.itemId = go.goodsDataInfo.itemId
        end
        go.titleInfoItem[1]:ShowPanel(go.titleInfoItem[1])
    end
end

function TitleGoodsItem:Close()
    lastBg = nil
end