---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2018/10/25 11:49
---仓库商品
local class = require 'Framework/class'
require('Framework/UI/UIPage')
WareHouseGoodsItem = class('WareHouseGoodsItem')

--初始化方法   数据（读配置表）
function WareHouseGoodsItem:initialize(goodsDataInfo,prefab,inluabehaviour, mgr, id)
    self.prefab = prefab;
    self.goodsDataInfo = goodsDataInfo;
    self._luabehaviour = inluabehaviour
    self.manager = mgr
    self.id = id
    self.nameText = self.prefab.transform:Find("TransportItem/Goods/Name/NameText").gameObject:GetComponent("Text");
    self.numberText = self.prefab.transform:Find("TransportItem/Goods/Number/NumberText").gameObject:GetComponent("Text");
    self.deleteBtn = self.prefab.transform:Find("WareHouseItem/Delete/DeleteButton").gameObject;
    self.select = self.prefab.transform:Find("TransportItem/Goods/Select").gameObject;
    self.select_while = self.prefab.transform:Find("TransportItem/Goods/Select/Select-white").gameObject;
    self.bgItem = self.prefab.transform:Find("WareHouseItem").gameObject;
    self.transportBG = self.prefab.transform:Find("TransportItem").gameObject;
    self.nameText.text = goodsDataInfo.name
    self.numberText.text = goodsDataInfo.number

    self._luabehaviour:AddClick(self.deleteBtn, self.OnDelete, self);
    self._luabehaviour:AddClick(self.bgItem, self.OnBGItem,self)
    self._luabehaviour:AddClick(self.transportBG,self.OnTransportBG,self)
end
--删除
function WareHouseGoodsItem:OnDelete(go)
    log("rodger_w8_GameMainInterface","[test_OnDelete]  测试完毕")
    local data = {}
    data.titleInfo = "提示"
    data.contentInfo = "确认销毁吗"
    data.tipInfo = "物品将永久消失"
    data.btnCallBack = function ()
        go.manager:_deleteGoods(go)
    end
   ct.OpenCtrl('BtnDialogPageCtrl',data)

end

function WareHouseGoodsItem:OnBGItem()
    local data = {}
    data.madeBy = "来自Rodger公司"
    data.playerName = " rodger"
    ct.OpenCtrl('MessageTooltipCtrl',data)
end

--点击运输后的BG
function WareHouseGoodsItem:OnTransportBG(go)
    log("rodger_w8_GameMainInterface","[test_c_OnTransportBG]  测试完毕")
    local goodsDataInfo = {};
    goodsDataInfo.name =  go.goodsDataInfo.name;
    goodsDataInfo.number = go.goodsDataInfo.number;
    goodsDataInfo.id = go.id;
    go.manager:_creatTransportGoods(goodsDataInfo);
    go.select_while:SetActive(false);
    go.transportBG:GetComponent("Button").enabled = false;
end

--删除后刷新ID及刷新显示
function WareHouseGoodsItem:RefreshID(id)
    self.id = id
end

function WareHouseGoodsItem:setActiva(isSelect)
    self.select:SetActive(not isSelect);
    self.bgItem:SetActive(isSelect);
end

function WareHouseGoodsItem:Enabled()
    self.select_while:SetActive(true);
    self.transportBG:GetComponent("Button").enabled = true
end