---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xuyafang.
--- DateTime: 2019/2/27 15:54
---
local transform
MapPanel = {}
local this = MapPanel

MapPanel.MapShowInfoPoolName = "MapShowInfo"
MapPanel.MapShowInfoHasImgPoolName = "MapShowInfoHasImg"

---Start event----
function MapPanel.Awake(obj)
    transform = obj.transform
    this.InitPanel()
end

--Initialization panel--
function MapPanel.InitPanel()
    --Buttons and sliders
    this.scaleSlider = transform:Find("rightRoot/ScaleSlider"):GetComponent("Slider")
    this.enlargeBtn = transform:Find("rightRoot/enlargeBtn")
    this.narrowBtn = transform:Find("rightRoot/narrowBtn")
    this.backBtn = transform:Find("rightRoot/backBtn")

    --Prefab
    this.mapMatGoodRootItem = transform:Find("prefabRoot/MapMatGoodRootItem").gameObject -- raw product details root node
    this.mapMatGoodSearchItem = transform:Find("prefabRoot/MapMatGoodSearchItem").gameObject -- raw product details
    this.mapSearchTypeItem = transform:Find("prefabRoot/MapSearchTypeItem").gameObject -- search type
    this.mapPromotionDetailItem = transform:Find("prefabRoot/MapPromotionDetailItem").gameObject -- promote item
    this.mapTechnologyDetailItem = transform:Find("prefabRoot/MapTechnologyDetailItem").gameObject -- scientific research
    this.mapBuildsDetailItem = transform:Find("prefabRoot/MapBulidsDetailItem").gameObject --building item
    --
    this.mapBuildingItem = transform:Find("centerRoot/prefabRoot/MapBuildingItem") -- construction bubble
    this.mapSystemItem = transform:Find("centerRoot/prefabRoot/MapSystemItem") -- system architecture
    this.mapSearchResultItem = transform:Find("centerRoot/prefabRoot/MapSearchResultItem")--search results
    this.mapAllSearchItem = transform:Find("centerRoot/prefabRoot/MapAllSearchItem") --Search overview
    this.mapGroundAucItem = transform:Find("centerRoot/prefabRoot/MapGroundAucItemNew") -- land auction
    this.mapGroundTransItem = transform:Find("centerRoot/prefabRoot/MapGroundTransItem") -- land transaction

    --Bubble level root
    this.mapRootRect = transform:Find("centerRoot/typeParent"):GetComponent("RectTransform") --small map
    this.groundTransformRoot = transform:Find("centerRoot/typeParent/GroundTransformRoot")--transaction bubble
    this.groundAuctionRoot = transform:Find("centerRoot/typeParent/GroundAuctionRoot") --Auction bubble
    this.alwaysShowRoot = transform:Find("centerRoot/typeParent/AlwaysShowRoot")--the interface that has been displayed all the time, own building & system building
    this.allSearchRoot = transform:Find("centerRoot/typeParent/AllSearchRoot") --Search overview
    this.detailSearchRoot = transform:Find("centerRoot/typeParent/DetailSearchRoot") --Search details

    --Search type on the left
    this.openTypeBtnRect = transform:Find("leftRoot/openTypeBtn"):GetComponent("RectTransform") -- button to open the search box on the left
    this.closeSearchBtn = transform:Find("leftRoot/typeOpen/closeSearchBtn"):GetComponent("RectTransform") -- close the search main interface button
    this.typeOpenRect = transform:Find("leftRoot/typeOpen"):GetComponent("RectTransform") --Search the main interface
    this.loadingImgTran = transform:Find("leftRoot/typeOpen/loadingRoot/loadingImg"):GetComponent("RectTransform") --loading diagram
    this.typeItemParent = transform:Find("leftRoot/typeOpen/typeItemParent") -- Search for the type parent object

    --Search details page
    this.detailPagesRect = transform:Find("leftRoot/detailPages"):GetComponent("RectTransform") --
    this.matPageToggleGroup = transform:Find("leftRoot/detailPages/matPage"):GetComponent("ToggleGroup") --raw material page
    this.goodsPageToggleGroup = transform:Find("leftRoot/detailPages/goodsPage"):GetComponent("ToggleGroup") -- product page
    this.buildsPageToggleGroup = transform:Find("leftRoot/detailPages/buildsPage"):GetComponent("ToggleGroup") --building page
    this.promotionPageGroup = transform:Find("leftRoot/detailPages/promotionPage"):GetComponent("ToggleGroup") --Promotion
    this.technologyPageGroup = transform:Find("leftRoot/detailPages/technologyPage"):GetComponent("ToggleGroup") --Scientific research

    --Detail interface on the right
    --this.rightMatGoodPageItem = MapRightMatGoodPage:new(transform:Find("rightPageRoot/searchMatGood")) --old
    this.rightOtherPageRoot = transform:Find("rightPageRoot") --
    this.rightOtherBuildingPageItem = MapRightOtherBuildingPage:new(transform:Find("rightPageRoot/selectOtherBuilding")) -- Click the search result bubble to open the building interface
    this.rightGroundAucPageItem = MapRightGroundAucPage:new(transform:Find("rightPageRoot/searchGroundAuc")) -- Click on the auction bubble
    this.rightGroundTransPageItem = MapRightGroundTransPage:new(transform:Find("rightPageRoot/searchGroundTrans")) -- land transaction
    this.selfBuildingPageItem = MapRightSelfBuildingPage:new(transform:Find("rightPageRoot/selectSelfBuilding")) -- own building
    this.systemBuildingPageItem = MapRightSystemPage:new(transform:Find("rightPageRoot/selectSystemBuilding")) -- system building

    this.mapShowInfoParentTran = transform:Find("rightPageRoot/itemsRoot")--the following two pre-made recycling parent objects
    this.mapShowInfoItemTran = transform:Find("rightPageRoot/itemsRoot/noIconShowItem") --Data display without icon
    this.mapShowInfoIconItemTran = transform: Find("rightPageRoot/itemsRoot/hasIconShowItem") -- data display with icon
    this.prefabPools = {}
    this.prefabPools[this.MapShowInfoPoolName] = LuaGameObjectPool:new(this.MapShowInfoPoolName, this.mapShowInfoItemTran, 5, Vector3.New(-999,-999,-999), this.mapShowInfoParentTran)
    this.prefabPools[this.MapShowInfoHasImgPoolName] = LuaGameObjectPool:new(this.MapShowInfoHasImgPoolName, this.mapShowInfoIconItemTran, 1, Vector3.New(-999,-999,-999), this.mapShowInfoParentTran)
end
--Displays the secondary menu by type
function MapPanel.showDetailPageByType(typeId)
    MapPanel.matPageToggleGroup.transform.localScale = Vector3.zero
    MapPanel.goodsPageToggleGroup.transform.localScale = Vector3.zero
    MapPanel.buildsPageToggleGroup.transform.localScale = Vector3.zero
    MapPanel.promotionPageGroup.transform.localScale = Vector3.zero
    MapPanel.technologyPageGroup.transform.localScale = Vector3.zero

    if typeId == EMapSearchType.Material then
        MapPanel.matPageToggleGroup.transform.localScale = Vector3.one
    elseif typeId == EMapSearchType.Goods then
        MapPanel.goodsPageToggleGroup.transform.localScale = Vector3.one
    elseif typeId == EMapSearchType.Builds then
        MapPanel.buildsPageToggleGroup.transform.localScale = Vector3.one
    elseif typeId == EMapSearchType.Promotion then
        MapPanel.promotionPageGroup.transform.localScale = Vector3.one
    elseif typeId == EMapSearchType.Technology then
        MapPanel.technologyPageGroup.transform.localScale = Vector3.one
    end
end
--Return to the secondary menu trans
function MapPanel.getPageByType(typeId)
    local go
    if typeId == EMapSearchType.Material then
        go = MapPanel.matPageToggleGroup.gameObject
    elseif typeId == EMapSearchType.Goods then
        go = MapPanel.goodsPageToggleGroup.gameObject
    elseif typeId == EMapSearchType.Builds then
        go = MapPanel.buildsPageToggleGroup.gameObject
    elseif typeId == EMapSearchType.Promotion then
        go = MapPanel.promotionPageGroup.gameObject
    elseif typeId == EMapSearchType.Technology then
        go = MapPanel.technologyPageGroup.gameObject
    end
    return go
end
--
function MapPanel.closeAllRightPage()
    this.rightOtherBuildingPageItem:close()
    this.rightGroundAucPageItem:close()
    this.rightGroundTransPageItem:close()
    this.selfBuildingPageItem:close()
    this.systemBuildingPageItem:close()
end