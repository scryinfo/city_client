---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2019/8/21 15:17
---城市信息第三层item
--初始化方法   数据（读配置表）
TitleInfoItem = class('TitleInfoItem')
local lastBg

function TitleInfoItem:initialize(inluabehaviour, prefab, goodsDataInfo,itemId,type,insId)
    self.prefab = prefab;
    self.goodsDataInfo = goodsDataInfo;
    self._luabehaviour = inluabehaviour
    self.itemId = itemId
    self.id = goodsDataInfo.id
    self.type = type
    self.insId = insId

    self.notSelect = self.prefab.transform:Find("notSelectBg").gameObject
    self.notSelectText = self.prefab.transform:Find("notSelectBg/Text"):GetComponent("Text");
    self.select = self.prefab.transform:Find("selectBg")
    self.selectText = self.prefab.transform:Find("selectBg/Text"):GetComponent("Text");

    self.notSelectText.text = goodsDataInfo.name
    self.selectText.text = goodsDataInfo.name

    self._luabehaviour:AddClick(self.notSelect, self.OnNotSelect, self);
end

function TitleInfoItem:OnNotSelect(go)
    PlayMusEff(1002)
    go:ShowPanel(go)
    if go.id == 1 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_queryItemSales',go.type,go.itemId)  --查询营业额
    elseif go.id == 2 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_ItemSupplyAndDemand',go.type,go.itemId)  --查询供需
    elseif go.id == 3 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_queryItemAvgPrice',go.type,go.itemId)  --查询详情成交均价
    elseif go.id == 4 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_queryProductRanking',go.type,go.itemId,DataManager.GetMyOwnerID())  --查询详情玩家排行
    elseif go.id == 5 then
        DataManager.DetailModelRpcNoRet(go.insId, 'm_queryEvaGrade',go.type,go.itemId,2)  --查询详情玩家Eva
    end
end

function TitleInfoItem:ShowPanel(go)
    if lastBg then
        lastBg.notSelect.transform.localScale = Vector3.one
        lastBg.select.localScale = Vector3.zero
    end
    go.notSelect.transform.localScale = Vector3.zero
    go.select.localScale = Vector3.one
    lastBg = go
    CityInfoPanel.productContent.anchoredPosition = Vector3.zero
end

function TitleInfoItem:SetLast(bg)
    lastBg = bg
end