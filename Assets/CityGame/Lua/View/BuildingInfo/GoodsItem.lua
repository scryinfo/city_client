---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/10/27/027 17:51
---

require'View/BuildingInfo/MapAdvertisementItem'

require('Framework/UI/UIPage')
local class = require 'Framework/class'
GoodsItem = class('GoodsItem')

GoodsItem.AddedItem_Path="View/GoodsItem/MapAdvertisementItem"



---初始化方法   数据（读配置表）
function GoodsItem:initialize(prefabData,prefab,inluabehaviour, mgr, id)
    self.prefab = prefab;
    self.prefabData = prefabData;
    self._luabehaviour = inluabehaviour
    self.manager = mgr
    self.id = id
    self.ItemList=mgr.goodsItemList

    self.addBtn=self.prefab

    self._luabehaviour:AddClick(self.addBtn, self.OnClick_Add, self);

end
---添加
function GoodsItem:OnClick_Add(go)
    if MunicipalModel.owenerId==MunicipalModel.buildingOwnerId then--自已进入
        ---顶部处理
        go.manager.index=go.manager.index+1
        ---创建映射广告
        local item=go.manager:c_creatGoods(GoodsItem.AddedItem_Path,go.manager.transform)
        ---给映射广告赋值数据
        local prefabData={metaId=2151002}
        MapAdvertisementItem:new(prefabData,item,go._luabehaviour,go.manager,go.manager.index)
        ---选中广告不可在点击
        self:GetComponent("Image").raycastTarget=false;
        ---管理器表添加
        go.manager.addedItemList[go.manager.index]=item
        go.manager.selectItemList[go.manager.index]=self
        go.manager.AdvertisementDataList[go.manager.index]={count=1,type=0,ADperson=1001,metaId=2151002}

        ManageAdvertisementPosPanel.greyBtn.gameObject:SetActive(false);
    else--他人进入
        ---顶部处理
        go.manager.index=go.manager.index+1
        ---创建映射广告
        local item=go.manager:c_creatGoods(GoodsItem.AddedItem_Path,go.manager.transform)
        ---给映射广告赋值数据
        local prefabData={metaId=2151002}
        MapAdvertisementItem:new(prefabData,item,go._luabehaviour,go.manager,go.manager.index)
        ---选中广告不可在点击
        self:GetComponent("Image").raycastTarget=false;
        ---管理器表添加
        go.manager.addedItemList[go.manager.index]=item
        go.manager.selectItemList[go.manager.index]=self
        go.manager.AdvertisementDataList[go.manager.index]={count=1,type=0,ADperson=1001,metaId=2151002,slots=go.manager.current.slots}
        ---数字文本加减
        go.manager.current.numText.text=go.manager.current.updateAcount-1
        ---选中广告不可在点击
        self:GetComponent("Image").raycastTarget=false;
        ManageAdvertisementPosPanel.greyBtn.gameObject:SetActive(false);
    end
end












