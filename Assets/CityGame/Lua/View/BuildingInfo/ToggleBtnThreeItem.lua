---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by ljw.
--- DateTime: 2019/5/14 17:43
---

ToggleBtnThreeItem = class('ToggleBtnThreeItem')

local optionThreeScript = {}
local volumeBehaviour
local insId
local playerdata = {}
local state
local type = true
local createTs --开服时间
---初始化方法   数据（读配置表）
function ToggleBtnThreeItem:initialize(prefab,luaBehaviour,data,ctrl)
    self.prefab = prefab
    volumeBehaviour = luaBehaviour
    self.data = data
    self.ctrl = ctrl

    --self.ima=prefab.transform:Find("Image"):GetComponent("Image");
    --self.deleteBtn=prefab.transform:Find("Button")
    self.foodtext = prefab.transform:Find("food/foodText"):GetComponent("Text")
    self.bgBtn = prefab.transform:Find("bgBtn")
    self.highlight = prefab.transform:Find("highlight")

    self.ToggleBtnThreeItem = UnityEngine.UI.LoopScrollDataSource.New()
    self.ToggleBtnThreeItem.mProvideData = ToggleBtnThreeItem.static.OptionTwoData
    self.ToggleBtnThreeItem.mClearData = ToggleBtnThreeItem.static.OptionTwoClearData

    insId = OpenModelInsID.VolumeCtrl
    self:Refresh(data)
    luaBehaviour:AddClick(self.bgBtn.gameObject,self._tradingOpenFunc,self)
end

---==========================================================================================点击函数=============================================================================
--打开交易折线图
function ToggleBtnThreeItem:_tradingOpenFunc(ins)
    VolumePanel.strade.localScale = Vector3.one
    if state ~= nil then
        state.localScale = Vector3.zero
    end
    state = ins.highlight
    ins.highlight.localScale = Vector3.one
    local info = {}
    info.id = ins.data.typeId
    info.exchangeType = ins.data.EX
    info.type = type
    DataManager.DetailModelRpcNoRet(insId , 'm_PlayerNumCurve',info)
    --DataManager.OpenDetailModel(VolumeModel,ins.insId )
    --DataManager.DetailModelRpcNoRet(insId , 'm_PlayerTypeNum')
    --DataManager.DetailModelRpcNoRet(insId , 'm_PlayerNumCurve',ins.data.typeId)
end

--删除2
function ToggleBtnThreeItem:c_OnClick_Roll(ins)
    ct.OpenCtrl("RollCtrl" , ins.data)
end


---==========================================================================================业务逻辑=============================================================================



-- 第二层信息展示
function ToggleBtnThreeItem:updateData( data )
    self.data = data
    self.foodtext.text = GetLanguage(self.data.name)
end

function ToggleBtnThreeItem:updateUI( data )
    --LoadSprite()
    if data.beginProcessTs > 0 then
        local curTime = TimeSynchronized.GetTheCurrentServerTime()
        local hasRunTime = curTime - data.beginProcessTs
    end
end

function ToggleBtnThreeItem:Refresh(data)
    self:updateData(data)
    --self:updateUI(data)
end

-- 第二层信息显示
ToggleBtnThreeItem.static.OptionTwoData = function(transform, idx)
    idx = idx + 1
    optionThreeScript[idx] = ToggleBtnThreeItem:new(transform, volumeBehaviour, DealConfig[idx].childs, idx)
end

ToggleBtnThreeItem.static.OptionTwoClearData = function(transform)
end

function ToggleBtnThreeItem:Aaa(data)
    playerdata = data
end
