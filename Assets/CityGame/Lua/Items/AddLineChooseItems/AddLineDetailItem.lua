---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xuyafang.
--- DateTime: 2018/12/5 10:34
---类型详细物品item
AddLineDetailItem = class('AddLineDetailItem')
function AddLineDetailItem:initialize(viewRect, data, toggleGroup)
    self.viewRect = viewRect
    self.data = data
    self.toggle = viewRect:GetComponent("Toggle")
    self.toggle.group = toggleGroup

    self.iconImg = viewRect:Find("iconImg"):GetComponent("Image")
    self.nameText = viewRect:Find("nameText"):GetComponent("Text")
    self.disableImg = viewRect:Find("disableImg"):GetComponent("Image")
    self.stateRoot = viewRect:Find("stateRoot")
    self.stateText = viewRect:Find("stateRoot/stateText"):GetComponent("Text")
    self.infoBtn = viewRect:Find("infoBtn")
    self.chooseImgTran = viewRect:Find("chooseImg")

    local stateData = AddLineChooseItemCtrl.GetItemState(data.itemId)
    --如果是可展示状态
    if stateData.enableShow then
        self.disableImg.transform.localScale = Vector3.zero
    else
        self.disableImg.transform.localScale = Vector3.one
    end
    if stateData.itemState == AddLineDetailItemState.InventIng then
        self.stateRoot.localScale = Vector3.one
        self.stateText.text = "Be inventing..."
    elseif stateData.itemState == AddLineDetailItemState.ToBeInvented then
        self.stateRoot.localScale = Vector3.one
        self.stateText.text = "To be invented"
    elseif stateData.itemState == AddLineDetailItemState.ResearchIng then
        self.stateRoot.localScale = Vector3.one
        self.stateText.text = "Be researching..."
    elseif stateData.itemState == AddLineDetailItemState.HasInvented then
        self.stateRoot.localScale = Vector3.one
        self.stateText.text = "Has invented"
    elseif stateData.itemState == AddLineDetailItemState.Default then
        self.stateRoot.localScale = Vector3.zero
    end

    local tempData
    if data.itemType == 0 then
        tempData = Material[data.itemId]
    else
        tempData = Good[data.itemId]
    end
    self.nameText.text = tempData.name
    LoadSprite(tempData.img, self.iconImg,true)
    self.iconImg:SetNativeSize()

    self.toggle.onValueChanged:RemoveAllListeners()
    self.toggle.onValueChanged:AddListener(function(isOn)
        self:showState(isOn)
        if isOn then
            self.data.backFunc(self.data.itemId, self.viewRect.transform.position, stateData.enableShow)  --显示中间的线路
        end
    end)
end
--根据itemId去查状态
function AddLineDetailItem:_showState(itemId)

end

--外部设置toggle状态
function AddLineDetailItem:setToggleIsOn(isOn)
    self.toggle.isOn = isOn
    self:showState(isOn)
end
--显示
function AddLineDetailItem:showState(select)
    if select then
        self.chooseImgTran.localScale = Vector3.one
    else
        self.chooseImgTran.localScale = Vector3.zero
    end
end
--清除选中状态
function AddLineDetailItem:cleanState()
    if self.toggle.isOn then
        self:setToggleIsOn(false)
    end
end