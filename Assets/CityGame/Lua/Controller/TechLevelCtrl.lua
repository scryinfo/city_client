---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by password.
--- DateTime: 2019/8/17 17:30
---城市科技等级
TechLevelCtrl = class('TechLevelCtrl',UIPanel)
UIPanel:ResgisterOpen(TechLevelCtrl)

local techLevelBehaviour

function TechLevelCtrl:bundleName()
    return "Assets/CityGame/Resources/View/TechLevelPanel.prefab"
end

function TechLevelCtrl:initialize()
    UIPanel.initialize(self,UIType.PopUp,UIMode.NeedBack,UICollider.None)
end

function TechLevelCtrl:Awake(go)
    self:_getComponent(go)
    techLevelBehaviour = self.gameObject:GetComponent('LuaBehaviour')
    techLevelBehaviour:AddClick(self.back,self.OnBack,self)

end

function TechLevelCtrl:Active()
    UIPanel.Active(self)
    self.name.text = GetLanguage(45010004)
    self.salary.text = GetLanguage(45010008)
    self.quit.text = GetLanguage(45010009)
    self.grades.text = GetLanguage(45010021)
    self.dotOne.text = GetLanguage(45010022)
    self.dotTwo.text = GetLanguage(45010023)
end

function TechLevelCtrl:Refresh()
    self:initData()
end

function TechLevelCtrl:Hide()
    UIPanel.Hide(self)

end

function TechLevelCtrl:Close()

end

function TechLevelCtrl:OnCreate(obj)
    UIPanel.OnCreate(self,obj)
end

function TechLevelCtrl:OnBack()
    UIPanel.ClosePage()
end

--获取组件
function TechLevelCtrl:_getComponent(go)
    self.back = go.transform:Find("bgBtn").gameObject
    self.name = go.transform:Find("contentRoot/top/topName"):GetComponent("Text")
    self.lv = go.transform:Find("contentRoot/content/lv"):GetComponent("Text")
    self.slider = go.transform:Find("contentRoot/content/Slider"):GetComponent("Slider")
    self.nextLv = go.transform:Find("contentRoot/content/Slider/nextLv"):GetComponent("Text")
    self.salary = go.transform:Find("contentRoot/content/salary"):GetComponent("Text")
    self.salaryText = go.transform:Find("contentRoot/content/salaryText"):GetComponent("Text")
    self.nextSalary = go.transform:Find("contentRoot/content/Image/Text"):GetComponent("Text")
    self.quit = go.transform:Find("contentRoot/content/quit"):GetComponent("Text")
    self.quitText = go.transform:Find("contentRoot/content/quitText"):GetComponent("Text")
    self.nextQuit = go.transform:Find("contentRoot/content/NextImage/Text"):GetComponent("Text")
    self.grades = go.transform:Find("contentRoot/grades"):GetComponent("Text")
    self.dotOne = go.transform:Find("contentRoot/dot/Text"):GetComponent("Text")
    self.dotTwo = go.transform:Find("contentRoot/dot/Text/dot/Text"):GetComponent("Text")
end

function TechLevelCtrl:initData()
    self.slider.maxValue =  CityLevel[self.m_data.level].exp
    self.slider.value = self.m_data.exp
    self.lv.text = "Lv." .. self.m_data.level
    self.nextLv.text = "Lv." .. self.m_data.level + 1
    self.salaryText.text = GetClientPriceString(CityLevel[self.m_data.level].salary)
    self.nextSalary.text = string.format("<color=%s>%s</color><color=%s>(%s)</color>","#5f6ba0", GetClientPriceString(CityLevel[self.m_data.level + 1].salary),
            "#00b7ee",tonumber(GetClientPriceString(CityLevel[self.m_data.level + 1].salary - CityLevel[self.m_data.level].salary)))
    self.quitText.text = CityLevel[self.m_data.level].inventCount
    self.nextQuit.text =  string.format("<color=%s>%s</color><color=%s>(%s)</color>","#5f6ba0", CityLevel[self.m_data.level + 1].inventCount,
            "#00b7ee", CityLevel[self.m_data.level + 1].inventCount)

end
