---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Fisher.
--- DateTime: 2019/7/31 9:41
---Construction Management Details

BuildingRevenueInfoModel = class('BuildingRevenueInfoModel',ModelBase)

function BuildingRevenueInfoModel:initialize(insId)
    self.insId = insId
    self:OnCreate()
end

function BuildingRevenueInfoModel:OnCreate()
    --local event 
    Event.AddListener("m_ReqBuildingRevenueInfo",self.m_ReqBuildingRevenueInfo,self)

    --Inquire today's construction details
    DataManager.ModelRegisterNetMsg(nil,"sscode.OpCode","queryTodayBuildingSaleDetail","ss.BuildingTodaySaleDetail",self.n_BuildingRevenueInfo,self)
    --Inquiry of construction history and operation details
    DataManager.ModelRegisterNetMsg(nil,"sscode.OpCode","queryHistoryBuildingSaleDetail","ss.BuildingHistorySaleDetail",self.n_BuildingHistoryRevenueInfo,self)
end

function BuildingRevenueInfoModel:Close()
    --local event 
    Event.RemoveListener("m_ReqBuildingRevenueInfo",self.m_ReqBuildingRevenueInfo,self)

    --Enquire about the construction details of today
    DataManager.ModelRemoveNetMsg(nil,"sscode.OpCode","queryTodayBuildingSaleDetail","ss.BuildingTodaySaleDetail",self.n_BuildingRevenueInfo,self)
    --Inquiry of construction history and operation details
    DataManager.ModelRemoveNetMsg(nil,"sscode.OpCode","queryHistoryBuildingSaleDetail","ss.BuildingHistorySaleDetail",self.n_BuildingHistoryRevenueInfo,self)
end

---Client request---
--Enquire about the construction details of today
function BuildingRevenueInfoModel:m_ReqBuildingRevenueInfo(buildingId,typeId)
    FlightMainModel.OpenFlightLoading()
    local msgId = pbl.enum("sscode.OpCode","queryTodayBuildingSaleDetail")
    local lMsg = {buildingId = buildingId,type = typeId}
    local pMsg = assert(pbl.encode("ss.QueryBuildingSaleDetail", lMsg))
    CityEngineLua.Bundle:newAndSendMsgExt(msgId, pMsg, CityEngineLua._tradeNetworkInterface1)
end
--Inquiry of construction history and operation details
function BuildingRevenueInfoModel:m_ReqBuildingHistoryRevenueInfo(buildingId,typeId,itemId,producerId)
    FlightMainModel.OpenFlightLoading()
    local msgId = pbl.enum("sscode.OpCode","queryHistoryBuildingSaleDetail")
    local lMsg = {buildingId = buildingId,type = typeId,itemId = itemId,producerId = producerId}
    local pMsg = assert(pbl.encode("ss.QueryHistoryBuildingSaleDetail", lMsg))
    CityEngineLua.Bundle:newAndSendMsgExt(msgId, pMsg, CityEngineLua._tradeNetworkInterface1)
end
---Server callback---
--Enquire about the construction details of today
function BuildingRevenueInfoModel:n_BuildingRevenueInfo(data)
    FlightMainModel.CloseFlightLoading()
    DataManager.ControllerRpcNoRet(self.insId,"BuildingRevenueInfoCtrl", 'revenueInfoData',data)
end
--Inquiry of construction history and operation details
function BuildingRevenueInfoModel:n_BuildingHistoryRevenueInfo(data)
    FlightMainModel.CloseFlightLoading()
    DataManager.ControllerRpcNoRet(self.insId,"BuildingRevenueInfoCtrl", 'historyRevenueInfoData',data)
end
