---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Tina.
--- DateTime: 2019/5/16 19:03
---

CompanyInputCtrl = class('CompanyInputCtrl',UIPanel)
UIPanel:ResgisterOpen(CompanyInputCtrl) --How to open the registration

function CompanyInputCtrl:initialize()
    UIPanel.initialize(self, UIType.PopUp, UIMode.DoNothing, UICollider.Normal)
end

function CompanyInputCtrl:bundleName()
    return "Assets/CityGame/Resources/View/CompanyInputPanel.prefab"
end

function CompanyInputCtrl:OnCreate(obj )
    UIPanel.OnCreate(self, obj)
end

function CompanyInputCtrl:Awake(go)
    self.gameObject = go
    self:_getComponent(go)
    self:_initData()

    self.luaBehaviour = go:GetComponent('LuaBehaviour')
end

function CompanyInputCtrl:Refresh()
    self:_initData()

    self.luaBehaviour:AddClick(self.closeBtn, self._onClickClose, self)
    self.luaBehaviour:AddClick(self.confimBtn, self._onClickConfim, self)
    self.input.onValueChanged:AddListener(function ()
        ct.log("cycle_w12_hosueServer", "----")  --Sensitive word detection
    end)
end

--Find components
function CompanyInputCtrl:_getComponent(go)
    self.titleText = go.transform:Find("Root/TitleText").gameObject:GetComponent("Text")
    self.closeBtn = go.transform:Find("Root/CloseBtn").gameObject
    self.confimBtn = go.transform:Find("Root/ConfirmBtn").gameObject
    self.input = go.transform:Find("Root/InputField").gameObject:GetComponent("InputField")
    self.inputPlaceholder = go.transform:Find("Root/InputField/Placeholder").gameObject:GetComponent("Text")
    self.tipsText = go.transform:Find("Root/TipsText"):GetComponent("Text")
end

--initialization
function CompanyInputCtrl:_initData()
    self.titleText.text = self.m_data.titleInfo
    self.tipsText.text = self.m_data.tipInfo

    -- Default value of input box
    if self.m_data.inputInfo then
        self.input.text = self.m_data.inputInfo
    end

    -- Number of input boxes
    if self.m_data.characterLimit then
        self.input.characterLimit = self.m_data.characterLimit
    else
        self.input.characterLimit = 0
    end

    -- Prompt value of input box
    if self.m_data.inputDefaultStr ~= nil then
        self.inputPlaceholder.text = self.m_data.inputDefaultStr
    else
        self.inputPlaceholder.text = ""
    end
end

--Click the confirm button
function CompanyInputCtrl:_onClickConfim(ins)
    ---Here self is the btn component passed in, and table is the instance
    local inputValue = ins.input.text
    if inputValue == "" then
        return
    end

    ---test
    if ins.m_data.btnCallBack then
        ins.m_data.btnCallBack(inputValue)
    end
    ins:_onClickClose(ins)
end

--Click the close button
function CompanyInputCtrl:_onClickClose(ins)
    PlayMusEff(1002)
    --ct.log("cycle_w12_hosueServer", "InputDialogPageCtrl:_onClickClose")
    ins.input.text = ""
    ins.luaBehaviour:RemoveClick(ins.confimBtn.gameObject, ins._onClickConfim, ins)
    ins.luaBehaviour:RemoveClick(ins.closeBtn.gameObject, ins._onClickClose, ins)
    UIPanel.ClosePage()
end

function CompanyInputCtrl:Hide()
    UIPanel.Hide(self)
end