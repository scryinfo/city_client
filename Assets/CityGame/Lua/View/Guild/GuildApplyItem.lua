---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Tina.
--- DateTime: 2019/2/26 18:34
---



GuildApplyItem = class("GuildApplyItem")

function GuildApplyItem:initialize(prefab, data)
    self.prefab = prefab
    self.data = data

    local transform = prefab.transform
    self.nameText = transform:Find("NameText"):GetComponent("Text")
    self.companyText = transform:Find("CompanyText"):GetComponent("Text")
    self.validationMsgText = transform:Find("ValidationImage/ValidationMsgText"):GetComponent("Text")
    self.agreeBtn = transform:Find("AgreeBtn"):GetComponent("Button")
    self.refuseBtn = transform:Find("RefuseBtn"):GetComponent("Button")

    self.nameText.text = "Avene&Thermale"
    self.companyText.text = "Labrador"
    self.validationMsgText.text = self.data.description

    self.agreeBtn.onClick:RemoveAllListeners()
    self.agreeBtn.onClick:AddListener(function ()
        self:_agreeGuildApplay()
    end)

    self.refuseBtn.onClick:RemoveAllListeners()
    self.refuseBtn.onClick:AddListener(function ()
        self:_refuseGuildApplay()
    end)
end

function GuildApplyItem:_agreeGuildApplay()
    PlayMusEff(1002)
    DataManager.DetailModelRpcNoRet(OpenModelInsID.GuildApplyCtrl, 'm_JoinHandle', { societyId = self.data.societyId, playerId = self.data.playerId, isAgree = true })
end

function GuildApplyItem:_refuseGuildApplay()
    PlayMusEff(1002)
    DataManager.DetailModelRpcNoRet(OpenModelInsID.GuildApplyCtrl, 'm_JoinHandle', { societyId = self.data.societyId, playerId = self.data.playerId, isAgree = false })
end