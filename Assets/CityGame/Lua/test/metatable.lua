---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by cyz_scry.
--- DateTime: 2018/9/17 16:37
---

local lu = require "Framework/pbl/luaunit"
local notEq = lu.assertEvalToFalse
local eq       = lu.assertEquals
local table_eq = lu.assertItemsEquals
local fail     = lu.assertErrorMsgContains

local parent = {
    house = 1
}

parent.__index = parent    --如果没有这一句话  child即使是设置parent为元表  也不能找到parent中的内容. __index指向的内容是nil（补充：更关键的是，派生类不能做到动态绑定）

local child = {
    wife = 2
}

setmetatable(child, parent)
print(child.house)
print(child.wife)

parent.__newindex = function ( t, k ,v )
    -- t[k] = v
    if k == "house" then
        parent[k] = v * 2
    end
end
-- 等效于
-- parent.__newindex = parent

function _G.testMetatable()
    --notEq(1 ~= 2)
    child.house = 3
    child.wife = 4

    print(child.house)
    print(child.wife)

    parent.__index = nil


    child.house = 5
    child.wife = 6

    print(child.house)
    print(child.wife)

    --打印结果是:
    -- 1
    -- 2
    -- 6
    -- 4
    -- nil
    -- 6
end
